#!/usr/bin/env php_cli
<?php
if (!isset($argv[1])) {
    echo 'Please define an action or use ./bonefish help' . PHP_EOL;
    exit(0);
}

$baseDir = dirname(__FILE__);
$composerAutoload = $baseDir . '/vendor/autoload.php';

if (!file_exists($composerAutoload))
    die('Please run Composer install first!');

require $baseDir . '/vendor/autoload.php';

\Bonefish\Core\Kernel::setBaseDir($baseDir);

$container = new Bonefish\DI\Container();
$container->setInterfaceImplementation('\Bonefish\DI\Container', '\Bonefish\DI\IContainer');

/** @var \Bonefish\Core\Kernel $kernel */
$kernel = $container->get('\Bonefish\Core\Kernel');
$kernel->lowLevelBoot();

/** @var \Bonefish\CLI\ICLI $cli */
$cli = $container->create('\Bonefish\CLI\ICLI');
$cli->setParameters($argv);
$cli->run();

exit(0);
?>
